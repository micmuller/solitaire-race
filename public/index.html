<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Solitaire HighNoon</title>
  <style>
    :root {
      --bg:#0b1020; --felt:#0f5132; --card:#fff; --ink:#0b1020; --muted:#9aa3b2; --radius:10px;
      /* Karten-/Layout-Variablen */
      --card-w: 86px;
      --card-h: 120px;
      --stack-yd: 24px;
    }
    html, body { height:100%; }
    body { margin:0; background: radial-gradient(1200px 800px at 50% 10%, #143b26, var(--felt)); color:#eef2ff; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial; display:grid; grid-template-rows:auto 1fr; gap:8px; }
    header { display:flex; align-items:center; gap:12px; padding:10px 14px; background:#0b1222aa; backdrop-filter: blur(6px); border-bottom:1px solid #ffffff12; position:relative; z-index:100; }
    header h1 { font-size:18px; margin:0; letter-spacing:.3px; display:flex; align-items:center; gap:8px; }
    header .controls { margin-left:auto; display:flex; gap:8px; flex-wrap:wrap; }
    button, input { border-radius:8px; border:1px solid #ffffff22; background:#0b1222; color:#e5e7eb; padding:8px 10px; }
    button.primary { background:#1f2937; border-color:#ffffff33; }
    .badge { font-size:12px; padding:2px 8px; border-radius:999px; background:#ffffff14; border:1px solid #ffffff22; }

    .board-wrapper { width:1200px; height:900px; transform-origin: top center; margin:0 auto; position:relative; z-index:1; }
    @media (prefers-reduced-motion:no-preference){ .board-wrapper{ transition: transform .2s ease-out; } }

    .board { position:relative; z-index:2; display:grid; grid-template-rows: auto 1fr auto; gap:18px; padding:14px; height:100%; }

    .row-top, .row-mid, .row-bot { display:grid; align-content:start; }

    .player-zone { display:grid; grid-template-rows: auto 1fr; gap:12px; }
    .zone-title { font-size:12px; text-transform:uppercase; letter-spacing:.12em; color:var(--muted); }

    .row { display:flex; gap:10px; align-items:flex-start; }
    .stack, .pile, .foundation { width:var(--card-w); height:var(--card-h); border-radius:var(--radius); background:#00000022; border:1px dashed #ffffff2a; position:relative; flex:0 0 auto; }
    .pile { min-width:var(--card-w); }
    .tableau { display:flex; gap:10px; }

    .card { width:var(--card-w); height:var(--card-h); border-radius:var(--radius); background:var(--card); color:var(--ink); position:absolute; top:0; left:0; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:22px; user-select:none; box-shadow:0 6px 14px #00000055; border:1px solid #0b102022; z-index:5; }
    .card.red { color:#b91c1c; }
    .card.black { color:#0b1020; }
    .card.faceDown { background: linear-gradient(135deg, #172554, #1e293b); color:#e5e7eb; border-color:#0ea5e9; box-shadow:0 6px 14px #0006 inset; }
    .card.dragging { transform: scale(1.06) rotate(-2deg); z-index:999; box-shadow:0 14px 30px #00000088; }

    .row-mid { position:relative; z-index:10; display:grid; grid-auto-rows:min-content; align-content:center; }
    .foundations-wrap { display:grid; justify-content:center; }
    .foundations { display:grid; grid-template-columns: repeat(8, var(--card-w)); gap:10px; justify-content:center; }
    .foundations .foundation::after { content: attr(data-suit); position:absolute; bottom:6px; right:8px; font-size:18px; opacity:.35; }

    .hint { font-size:12px; color:#cbd5e1; opacity:.8; text-align:center; margin-top:8px; }
    .divider { height:1px; background:#ffffff15; margin:8px auto; width:70%; }

    .row-top, .row-bot { position:relative; z-index:1; }
    .opponent { opacity:.95; }
    .small { font-size:11px; color:#9aa3b2; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#111827; padding:1px 6px; border-radius:6px; border:1px solid #ffffff22; }

    .overlay { position:fixed; bottom:12px; right:12px; z-index:50; min-width:220px; background:#0b1222cc; border:1px solid #ffffff22; border-radius:12px; padding:10px 12px; box-shadow:0 6px 20px #0008; pointer-events:none; }
    .overlay * { pointer-events:auto; }
    .overlay h3 { margin:0 0 6px; font-size:13px; letter-spacing:.08em; text-transform:uppercase; color:#cbd5e1; }
    .overlay .kv { display:grid; grid-template-columns:110px 1fr; gap:6px 8px; font-size:12px; }
    .dot { display:inline-block; width:8px; height:8px; border-radius:999px; background:#ef4444; vertical-align:middle; margin-right:6px; }
    .dot.ok { background:#22c55e; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }

   /* v2.9.10 – header & controls skalieren mit --ui-scale */
:root{
  --ui-scale: 1;          /* wird von scaling.js gesetzt (0.5–1.0) */
  --ui-font: 14px;        /* Basis, skaliert mit --ui-scale */
}

header{
  font-size: calc(var(--ui-font) * var(--ui-scale));
  gap: calc(8px * var(--ui-scale));
  padding: calc(8px * var(--ui-scale)) calc(12px * var(--ui-scale));
}

header h1{
  font-size: calc(18px * var(--ui-scale));
  gap: calc(8px * var(--ui-scale));
}

.badge{
  font-size: calc(12px * var(--ui-scale));
  padding: calc(2px * var(--ui-scale)) calc(8px * var(--ui-scale));
  border-radius: 999px;
}

header .controls{
  gap: calc(8px * var(--ui-scale));
}

header .controls input{
  padding: calc(6px * var(--ui-scale)) calc(10px * var(--ui-scale));
  min-width: max(100px, calc(110px * var(--ui-scale)));
  max-width: calc(220px * var(--ui-scale));
}

header .controls button{
  padding: calc(6px * var(--ui-scale)) calc(10px * var(--ui-scale));
  border-radius: calc(8px * var(--ui-scale));
}

.toast{
  padding: calc(10px * var(--ui-scale)) calc(12px * var(--ui-scale));
  border-radius: calc(10px * var(--ui-scale));
}

/* Board bleibt mittig (aus deiner Variante) */
.board-wrapper{
  display:flex; align-items:center; justify-content:center; margin:0 auto; place-self:center;
}
  </style>
</head>
<body>
  <header>
    <h1>Solitaire HighNoon <span class="badge" id="ver">v?</span></h1>
    <div class="controls">
      <input id="room" placeholder="Room-ID" title="Room/Match ID" />
      <input id="seed" placeholder="Seed (optional)" title="Deterministische Mischung" />
      <button id="newGame" class="primary">Neu starten</button>
      <button id="connect">Verbinden</button>
      <button id="toggleMirror" class="primary" title="Ansicht spiegeln">Mirror: On</button>
      <span class="small">Aktionen: <span id="moves">0</span></span>
    </div>
  </header>

  <div class="overlay" id="overlay">
    <h3>Status</h3>
    <div class="kv">
      <div>Sync</div><div><span class="dot" id="dot"></span><span id="ov-sync">offline</span></div>
      <div>Room</div><div class="mono" id="ov-room">—</div>
      <div>Seed</div><div class="mono" id="ov-seed">—</div>
      <div>Peers</div><div id="ov-peers">0</div>
      <div>Latency</div><div id="ov-latency">—</div>
      <div>Last msg</div><div id="ov-last">—</div>
      <div>Version</div><div id="ov-version">—</div>
    </div>
  </div>

  <main class="board-wrapper">
    <section class="board" id="board">

      <div class="row-top opponent">
        <div class="player-zone" id="oppCol">
          <div>
            <div class="zone-title" style="text-align:center">Gegner Stock/Waste</div>
            <div class="row" style="justify-content:center">
              <div class="stack" id="opp-stock"></div>
              <div class="stack" id="opp-waste"></div>
            </div>
          </div>
          <div>
            <div class="zone-title" style="text-align:center">Gegner 7 Tableaus</div>
            <div class="tableau" id="opp-tableau" style="justify-content:center"></div>
          </div>
        </div>
      </div>

      <div class="row-mid">
        <div class="zone-title" style="text-align:center">Gemeinsame Foundations (8 Stapel, 2×♥♦♣♠)</div>
        <div class="foundations-wrap">
          <div class="foundations" id="foundations"></div>
        </div>
        <div class="hint">Sequenz-Moves, Auto-Move (Doppelklick), Recycle (Waste→Stock).</div>
        <div class="divider"></div>
      </div>

      <div class="row-bot">
        <div class="player-zone" id="youCol">
          <div>
            <div class="zone-title" style="text-align:center">Dein Stock/Waste</div>
            <div class="row" style="justify-content:center">
              <div class="stack" id="you-stock"></div>
              <div class="stack" id="you-waste"></div>
            </div>
          </div>
          <div>
            <div class="zone-title" style="text-align:center">Deine 7 Tableaus</div>
            <div class="tableau" id="you-tableau" style="justify-content:center"></div>
          </div>
        </div>
      </div>

    </section>
  </main>

  <div class="toast" id="toast"></div>

  <script src="./js/scaling.js" defer></script>
  <script src="./js/game.js" defer></script>
</body>
</html>